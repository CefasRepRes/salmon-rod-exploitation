---
# Document details
title: "Estimation of returning Atlantic salmon stock from rod exploitation rate for principal salmon rivers in England & Wales"
# date: "`r format(Sys.time(), '%A %d %B %Y')`"
author: "Stephen D. Gregory^1,2,3,*^, Jonathan P. Gillson^4^, Katie Whitlock^5^, Jon Barry^4^, Peter Gough^6^, Robert J. Hillman^5^, David Mee^6^, Graeme Peirson^5^, Brian A. Shields^5^, Lawrence Talks^5^, Simon Toms^5^, Alan M. Walker^4^, Ben Wilson^6^, Ian C. Davidson^6^"
abstract: |

  ^1^ Salmon & Trout Research Centre, Game and Wildlife Conservation Trust, East Stoke, BH20 6BB, UK
  
  ^2^ Centre for Environment, Fisheries and Aquaculture Science, Barrack Road, Weymouth, DT4 8UB, UK
  
  ^3^ Centre for Conservation Ecology and Environmental Sciences, Faculty of Science and Technology, Bournemouth University, Talbot Campus, Poole, Dorset, BH12 5BB, UK

  ^4^ Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, NR33 0HT, UK

  ^5^ Environment Agency, Horizon House, Deanery Rd, Bristol, BS1 5AH, UK
  
  ^6^ Natural Resources Wales, Ty Cambria, 29 Newport Rd, Cardiff, CF24 0TP, UK
  
  \* Corresponding author: tel: +44 1305 206 703; email: [stephen.gregory@cefas.gov.uk](mailto:stephen.gregory@cefas.gov.uk).
  
# Output details
format: docx

# References
csl: ices-journal-of-marine-science.csl # more at www.zotero.org/styles
bibliography: references.bib
link-citations: true

# editor
editor: source

# Analysis details
version: "`r version$version.string`"
packages: "`r names(sessionInfo()$otherPkgs)`"
dependencies: "none"
---

```{r doc_setup, echo = FALSE, warning = FALSE, message = FALSE}

# clear workspace
rm(list = ls())

# document setup ----------------------------------------------------------

# libraries
library(knitr, quietly = TRUE)
opts_knit$set(warning = FALSE, message = FALSE, commment = NA, eval = FALSE)
opts_chunk$set(fig.width = 12, fig.height = 8, fig.path = "plots/", 
               echo = FALSE, warning = FALSE, message = FALSE)
library(here)
library(readxl)

# inline tables and figures
inline <- TRUE

```

**Short title:** Atlantic salmon stock estimates from rod exploitation rates

**Keywords:** angling, model extrapolation, rod exploitation, *Salmo salar*, stock assessment

\newpage

# Abstract

For effective fishery management, estimated stock sizes, along with their uncertainties, should be accurate, precise, and unbiased. Atlantic salmon *Salmo salar* stock assessment in England and Wales (and elsewhere across the Atlantic) estimate returning salmon stocks by applying a measure of rod exploitation rate (RER), derived from less abundant fishery-independent stock estimates, to abundant fishery-dependent data. Currently, RER estimates are generated for individual Principal Salmon Rivers based on available local data and assumptions. We propose a single, consistent, transparent and statistically-robust method to estimate salmon stocks that transfers strength of information from “data-rich” rivers, i.e., those with fisheries-independent data, to “data-poor” rivers without such data. We proposed, fitted, simplified, and then validated a Beta-Binomial model of RER, including covariates representing angler and fish behaviours, and river flow, and random effects to control for nuisance effects. Our “best” model revealed covariate effects in line with our hypotheses and generalised to data not used to train it. We used this model to extrapolate stock estimates from 12 data-rich to 52 data-poor rivers, together with their uncertainties. The resulting river-specific salmon stock estimates were judged to be useful and can be used as key inputs to river-specific, national, and international salmon stock assessments.

\newpage

<!-- Analysis starts here Analysis starts here Analysis starts here Analysis starts here -->

```{r analysis}

# choose analysis ---------------------------------------------------------

# choose analyses
do__orgRCdb <- 0
do__psrData <- 0
do__varsRCdb <- 0
do__varsEnv <- 0
do__explPlots <- 0
do__modelFitting <- 0
do__modelValidation <- 0
do__modelInference <- 0
do__modelExtrapolation <- 0

# r setup -------------------------------------------------------------------
source(here("scripts", "r-setup.R"))

# libraries & functions ---------------------------------------------------
source(here("scripts", "libraries-and-functions.R"))

# analysis options --------------------------------------------------------
source(here("scripts", "analysis-options.R"))

# global variables --------------------------------------------------------
source(here("scripts", "global-variables.R"))

# if any analyses chosen, then do analysis
anly_choices <- sapply(ls(pattern = "do__"), function(v) eval(parse(text = v)))
do__anly <- ifelse(any(as.logical(anly_choices)), 1, 0)
if (do__anly) {
  
  # organise rod catch database (RCdb) --------------------------------------
  if (do__orgRCdb) source(here("scripts", "00-orgRCdb.R"))
  
  # principal salmon river (PSR) data ---------------------------------------
  if (do__psrData) source(here("scripts", "01-psrData.R"))
  
  # calculate variables from RCdb -------------------------------------------
  if (do__varsRCdb) source(here("scripts", "02-varsRCdb.R"))
  
  # calculate environmental variables ---------------------------------------
  if (do__varsEnv) source(here("scripts", "03-varsEnv.R"))
  
  # exploratory plots -------------------------------------------------------
  if (do__explPlots) source(here("scripts", "04-explPlots.R"))
  
  # fit statistical models --------------------------------------------------
  if (do__modelFitting) source(here("scripts", "05-modelFitting.R"))
  
  # validate statistical models ---------------------------------------------
  if (do__modelValidation) source(here("scripts", "06-modelValidation.R"))
  
  # make statistical inferences ---------------------------------------------
  if (do__modelInference) source(here("scripts", "07-modelInference.R"))
  
  # extrapolate model -------------------------------------------------------
  if (do__modelExtrapolation) source(here("scripts", "08-modelExtrapolation.R"))
  
  # close -------------------------------------------------------------------
  source(here("scripts", "close.R"))
  
}
  
```

<!-- Document starts here Document starts here Document starts here Document starts here -->

# Introduction

The primary objective of Atlantic salmon *Salmo salar* (hereafter *salmon*) fishery management is to ensure the sustainable exploitation of their stocks [@Quinn1999], i.e., to ensure that sufficient numbers of adult salmon spawning escapement takes place to assure the safe state of future generations. To implement appropriate fishery management measures, we must first estimate the size of the returning adult stock available to the fishery, assess the status of that stock in terms of the numbers of adult fish that are subsequently available to spawn and how this has changed over time. In order to evaluate status, measures are usually compared to some predetermined standard (or standards). This process usually involves provision of estimates by quantitative modelling, broadly referred to as stock assessment [@Quinn1999]. In England and Wales (*E&W*) - and elsewhere around the North Atlantic basin - salmon stock management is underpinned, following the North Atlantic Salmon Conservation Organisation (NASCO) guidance [@NASCO2009], by the application of biological reference points [@Potter2003], which are derived from the relationship between the estimated annual spawning stock size and the estimated subsequent recruitment of spawners (or earlier life-stages) due to the reproduction of that estimated annual spawning stock [@Prevost2003; @White2016]. From this spawner--recruitment relationship, various biological reference points can be estimated. In E&W, as in other International Council of the Exploration of the Sea (ICES) jurisdictions [@White2023], the concept of Maximum Sustainable Yield is used as the basis for defining biological reference points, including the setting of a lower limit spawning stock size (or their equivalent in number of eggs), known as the *Conservation Limit*. An associated fishery *Management Objective* has been set that states that a river stock should equal or exceed its Conservation Limit in at least four years out of five on average (Centre for Environment, Fisheries & Aquaculture Sciences [Cefas], Environment Agency [EA], and Natural Resources Wales [NRW]; @Cefas2020) and follows the precautionary approach recommended by NASCO [@NASCO1998] and adopted by the IICES [@ICES-WGNAS2023; @Davidson2017].

Given the purpose of salmon stock assessment and its use in managing fishery exploitation, it is imperative that estimates of the sizes of the adult salmon stock returning to rivers (hereafter *salmon stocks*), and subsequent spawning stocks, are as accurate, precise and unbiased as possible, and provided with measurements of their uncertainties [@Crozier2003; @Rivot2019; @Potter2004; @Rivot2001; @Prevost2003]. Broadly, estimates of salmon stocks can be obtained by fishery-dependent and fishery-independent methods, and each has advantages and disadvantages [@Maunder2013; @Maunder2015; @Bentley2015]. Fishery-dependent methods rely on catches by recreational and commercial fishers whose activities cover a large spatial and temporal extent, but whose choices and behaviours can result in complex and potentially subjective indicators of stock size, which is also unavailable if the fishery is closed [@Maunder2004; @Arlinghaus2007]. In contrast, fisheries-independent data are collected using specific protocols to enumerate the stock directly, often using devices that include automated resistivity, acoustic or optical fish counters, or the use of partial or total traps -- the former includes use of capture-mark-recapture methods to derive full return estimates [@Eatherley2005]. Typically, these devices are operated with a degree of standardisation and validation, thereby produce a somewhat objective measure of stock size [@Dunkley1982]. Their high implementation and ongoing costs, however, mean that they produce data that are restricted spatially and temporally [@Eatherley2005; @Cowx2003; but see @Smith1996]. Hence, for example, only 12 of the 64 rivers where assessments are undertaken for salmon stocks in E&W have reported or continue to report a fishery-independent returning stock estimate (*RSE*) [@Cefas2020].

Around the North Atlantic Area, salmon stocks are estimated using numerous different but related methods depending on, *inter alia*, the management framework, available data, and suitable expertise. An early and widespread method is to raise declared salmon catches [adjusted for catch reporting rates and known as *total catches*: @Small1985] to RSEs by applying a measure of stock exploitation by anglers [known as the *salmon rod exploitation rate* (hereafter *RER*): @Solomon1992; @Milner2001; @OConnell2003]. An important motivation underpinning the development and adoption of the RER method is the large amount of spatio-temporal fish catch data generated by anglers and collated and reported in a regular and consistent manner [@Milner2001]. An extension of this approach, including exploitation by commercial fisheries, is used to reconstruct pre-fishery abundances that underpin international stock assessments [@Potter2004; @Olmos2020; @Rivot2019]. Where available data are more extensive, and accompanied by emerging statistical concepts and increasing computation power, new methods have been developed and are recommended [@Milner2001; @Maoileidigh2004], including models that separate ecological from observation processes [@Rivot2004; @Auger-Methe2021]. For example, some recent salmon stock assessment approaches in France have used quantitative modelling to integrate data from multiple life stages through time, thereby emulating the salmon's life-cycle, while accounting separately for the fish counting process [@Buoro2019; @Lebot2022]. Similar models have been partly developed in E&W [@Crozier2003, Chapter 10].

The primary method of estimating salmon stocks in E&W is based on the RER method [@Milner2001], although regional variations include more or less information and assumptions. The decision to use this approach was based on the widespread evidence of a strong and positive relationship between reported salmon catch by rod anglers and stock size [@Gargan2001; @Hansen2001; @Whelan2001; @Crozier2001; @Thorley2007], together with the abundance of available spatio-temporal catch data. In E&W, rod catch data for salmon (and sea trout *Salmo trutta*) have been collected in a consistent manner via a single national rod licence return-reminder system since 1994. Similar catch return systems operate in neighbouring jurisdictions, including Scotland (<https://marine.gov.scot/sma/assessment/salmon-and-sea-trout>), Ireland [@White2016] and France [@Buoro2019; @Lebot2022]. Such systems, including the E&W rod licence return data, collect information on the amount of effort spent angling on different rivers, and data on individual catches, including the species, size, and method of capture. These data can be used to reduce biases inherent in these fishery-dependent catch data.

To use fishery-dependent data for salmon stock assessment, we must confront and try to overcome some of its biases. There are several practical issues to consider when working with angler catches. They can represent fish [@Shelton2001a] and angler [@Gardiner2001] behaviours, and both might be influenced by other variables, such as the prevailing weather conditions [@Hendry2007]. The fates of captured fishes is important insomuch as a returned fish can be re-captured at a later time, whereas a killed fish cannot, and thus should not thereafter be considered as part of the spawning stock [@Leeuwen2020; @Thorstad2020]. There are several reasons why poorly audited catch returns could be unreliable, including accidental or deliberate under- or over-catch declaration by recreational and commercial fishers [@Potter2001]; a study by @Small1991 suggested that this possible bias could be corrected to give estimates of catches similar to those derived using capture-mark-recapture studies [@Potter2001]. Variations in stock sizes may be due to natural variability or be the result of human actions to manage their size. Aside from the practical issues, there are also issues relating to the quantitative modelling of exploitation rates. River flow is thought to affect the catchability and availability of fish [@Gee1980; @Gillson2020], but also the anglers' perception of those factors [@Aprahamian1995; @Milner2001]. Angling effort should have a strong and positive relationship with catch [e.g., @Gargan2001; @Gee1980; @Davidson2017], but some studies have found no such relationship [e.g., @Crozier2001], or even a negative relationship [e.g., @Beaumont1991]. Relationships among variables related to angling records are frequently highly noisy and this could be due to the omission of important sources of variation, such as differences within and between rivers [@Milner2001]. Nevertheless, catches have been found to be consistent with expectations at larger spatial and temporal scales [@Milner2001].

Our study aims to derive annual salmon stock estimates (with uncertainties) from RER for all principal salmon rivers across E&W using a single, consistent, transparent and statistically-robust method that transfers strength from the "data-rich" rivers with fisheries-independent data to "data-poor" rivers with fishery-dependent data. There were three main objectives to: (1) develop a statistical model describing RER measured on a subset of salmon rivers in E&W equipped with automated fish counting and/or trapping facilities (hereafter *fish counter* or *counter*) using an *a priori* defined set of expert-agreed potentially influential explanatory variables; (2) transfer that statistical model to other salmon rivers in E&W that are not equipped with fish counting facilities and for which RER cannot therefore be calculated directly; and, (3) use the estimated RERs to derive salmon stock estimates from rod catches for all major salmon-producing rivers across E&W. We developed a special case of the model proposed by @Lebot2022 in which fishery-independent available stock estimates are treated as constant data, rather than latent unobserved quantities, and in which we attempt to describe more of the variation in the RER with additional measured covariates, negating the need for the year-within-river random terms. In other respects, our approach generalises that of @Lebot2022 by allowing for overdispersion in catches given the stock, i.e., we use a Beta-Binomial regression as used by @Mantyniemi2015, and allowing non-linear effects of our covariates on catches from the available stock. We opt to use a Bayesian framework to allow uncertainty in the model parameter estimates to propagate through to the derived stock estimates. 

# Methods

Salmon stock size estimates are derived from adjusted catch data raised by an estimate of RER on the stock [@Solomon1992; @Shelton2001]. In essence, the exploitation rate of a stock is the proportion of the available salmon in the stock that were caught by anglers. Currently, the best measures of available stocks come from the 12 rivers where a fishery-independent RSE is reported and estimates of RER for these rivers are transported to rivers without a fishery-independent stock estimate. This process is akin to using "data-rich" stocks to inform "data-poor" stocks in marine fisheries [@Prevost2003; @Punt2011; @Bentley2015]. A variety of methods have been proposed and used in E&W (and elsewhere) to estimate RER. Early methods included a power function given by $catch / effort \propto abundance^b$ (or equivalently, $catch \propto effort \times abundance^b$), where $b$ has been estimated to be various values around 0.3-0.7 [@Small1991; @Gardiner2001]. However, this technique is known to predict unrealistically high values of rod exploitation that suggest catches greater than abundances [@Gardiner2001]. An alternative to this model included an effect allowing for saturation of fishing effort at high abundance [@Richards1986]. Recently, however, there has been a move towards the use of hierarchical Bayesian modelling, frequently built upon standard generalised linear models, often adapted to fit better highly variable data, such as Beta-Binomial regression [@Mantyniemi2015].

## Principal salmon river data and returning stock estimates

There are 64 rivers with monitored salmon stocks in E&W (Figure 1). These are known as principal salmon rivers (*PSR*) and our analysis was designed to estimate exploitation rates on them all. We collated data characterising each of these PSR.

<!-- Figure 1 -->

```{r figure1-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 1** Locations of the 64 principal salmon rivers (PSR) in England and Wales. Only 12 of these PSR (indicated by grey boxes) has a fish counter or trap to derive a returning stock estimate that is needed to calculate a rod exploitation rate."}
knitr::include_graphics(here("plots", "river-locations.jpg"))
```

Only 12 of these 64 PSR have a fish counter that could be used to calculate a fishery-independent RSE, namely the rivers Avon (Hants; short for Hampshire), Dee, Fowey, Frome, Itchen, Kent, Leven, Lune, Tamar, Teifi, Test and Tyne (Table 2; and @Cefas2020). Ideally, these rivers would have been purposely selected to capture the range of conditions experienced by salmon stocks across all the E&W PSRs, i.e., they would be a representative sample of salmon rivers [@Prevost2003]. Unfortunately, rivers are rarely selected for their representativeness, but rather for other, often historical or opportunistic, reasons [e.g., @Lebot2022]. Among these rivers, for example, fish counting/trapping facilities were installed in the chalk rivers (Table 1) and the rivers Fowey and Tamar primarily to monitor fish stock health with respect to changing water use (S. Toms, *pers. comm.*). In contrast, the rivers in Wales and northern England were largely selected for interest in the fish stocks *per se* and methods to monitor them (B. Shields, *pers. comm*). The issue of representativeness is important if we are to generalise findings from these RSE rivers to the other non-RSE PSRs; if they are not representative, then their generalisation will be limited. With this in mind, we designed our model to account for potential non-representativeness by including river random effects in fitting and extrapolating.

<!-- Table 1 -->

```{r table1-inline, eval = inline, echo = FALSE}
f_fle <- list.files(path = here(), 
                    pattern = "^rse-psr-descriptions.csv")
if (length(f_fle) != 0) {
  tab1 <- read.csv(here(f_fle), check.names = FALSE)
  tab1$Latitude <- round(tab1$Latitude, 3)
  tab1$Longitude <- round(tab1$Longitude, 3)
  tab1$`Fishery area (HA)` <- round(tab1$`Fishery area (HA)`)
  foo <- read_xlsx(here("rse-psr-descriptions-v1-2.xlsx"))
  # tab1$Period <- foo$Period
  # tab1$Duration <- foo$Duration
  # tab1$Gaps <- foo$Gaps
  tab1$Method <- foo$Method
  tab1$Months <- foo$Months
  tab1$Validation <- foo$Validation
  kable(tab1, caption = "**Table 1** Details of the 12 principal salmon rivers in England and Wales that derive a fishery-independent returning stock estimate (RSE). *Latitude* and *Longitude* are the given for the river mouth; *River type* is either 'Chalk' or 'Spate' as classified by their *Base Flow Index* (Figure S6); *Years* is the total number of annual returning stock estimates analysed; *Gaps* show the years during which a returning stock estimate was absent; *Method* denotes how the returning stock estimate is estimated; *Months* shows time of year to which the annual returning stock estimate corresponds; and *Validation* denotes the method of substantiating the returning stock estimate.", align = rep("l", dim(tab1)[2]), format = "pandoc")
} else {
  NULL
}
```


## Angler catch, effort and associated data

A national (statutory) catch return-reminder system was introduced in E&W in 1994, replacing various previously operated regional systems [@Cefas2020]. The current system requires that all anglers wishing to catch migratory salmonids purchase a rod licence and thereby are legally bound to report details of their angling catches and fishing effort to the EA (and its predecessors) by the end of the angling year [@Solomon1992]. Angling for salmon without a licence/or/and failing to provide a catch-return are offences and can incur a financial penalty [@Solomon1992]. Rod licence details and the catch-return data reported against them are kept by the EA in the National Rod Licence Catch Database (*RCdb*). A completely anonymised version of the RCdb provided the following data for each salmon caught: licence number, date, river and method of capture (fly, bait, spin), the weight of the fish (lbs/kg), and whether it was released or retained (fate). Aside from these individual fish records, the total number of fish caught/released (including nil returns) and fishing effort (angler-days for both salmon and sea trout combined) are requested from each licence holder for each river fished in each year.

There are three notable issues with rod licence and catch-return data [@Potter2001]. First, catch-return data are not submitted against all licences, despite repeated reminders and the associated risk of a fine [@Small1985]. @Small1991 analysed licence catch-returns and derived probable reporting rates and details of how they could be used to correct declared catch. On the basis of their work, a national rod catch declaration rate of 0.91 was derived for salmon in E&W and has been (for most rivers and in most years, except where catches from fisheries owners are judged to be more accurate and used) the sole correction applied to declared catches since 1994 to estimate total catches [@Davidson2017]. Second, effort spent fishing for salmon is not currently distinguished from effort spent fishing for other migratory fish, notably sea trout. While the effects of this composite fishing effort data might be limited given that salmon and sea trout co-occur in many of the PSRs [@Milner2007] and anglers targeting one species regularly catch the other [@Shields2007], questionnaires were sent to licence holders in 1992 and 2006 asking them to estimate the amount of effort they spent on each species. The results of these surveys have been used to calculate a river-specific mean (of 1992 and 2006) salmon angling effort rate ($\xi$) that has been applied to declared effort since 1994 [@Davidson2017]. Third, effort is sometimes omitted when catch-return data are submitted against a licence. To adjust for this, an effort declaration rate is calculated as the ratio between the declared catch and the declared catch with effort. For this study, both declared catch and declared effort were adjusted to account for these rates, thus: (1) declared catches were adjusted by the national rod catch declaration rate $\lambda$, which is taken to be 0.91 in most rivers in most years [@Small1985], to account for incomplete declarations, and (2) declared effort for salmon was calculated as $effort_{salmon} = declared effort \times \chi \times \xi \times \lambda$ where $\chi$ is the effort declaration rate, $\xi$ is the salmon angling effort rate, and $\lambda$ is the national licence declaration rate.

Given the adjusted declared effort for salmon, we calculated two measures of effort to include as explanatory variables in our statistical models of RER. First, we followed the approach taken by @Davidson2017 and scaled it to the river size so that it measured fishing days on salmon per hectare, i.e., *Angler effort* (Figure S1). Because @Davidson2017 found support for a non-linear (convex) relationship between exploitation rate and rod effort for sea trout, we explored a non-linear (convex) functional form in our statistical models of RER. Second, there are some suggestions that anglers can exert a disproportionate influence on exploitation rate if their effort yields a good return, perhaps due to their skill or persistence [@Beaumont1991; @Solomon1992]. To account for this, we calculated the proportion of declared effort for salmon that yielded a minimum of one salmon caught in that river and year, i.e., *Successful effort* (Figure S2). Both variables were *z*-standardised (subtracted mean and divided by the standard deviation) across rivers and years before including them in models as explanatory variables.

Aside from declared catch and effort data, the additional data on individual catches (e.g., capture method and fate) can be used to calculate additional and possibly river- and year-specific explanatory variables for inclusion in our statistical models of RER. Different capture methods, including the use of barbless hooks, are likely to influence exploitation rates: for salmon @Grilli2021, for sea trout @Shields2007. Calculation of an explanatory variable to represent capture method from the catch-return data is, however, challenging for two reasons: (1) capture method is often infrequently reported, and (2) river-specific byelaws and club restrictions are not always well documented and can censor the variable, i.e., making it appear as though restricted methods are less effective when they are actually banned. Given these potential issues, we did not consider further 'capture method' as an explanatory variable, but rather we explore in the Discussion the possible implications of that our decision, including proposals to include it as a subsequent extension to this work.

In contrast, the fate of individual fish was well-documented and could be used to calculate an explanatory variable *Release proportion* (Figure S3). This explanatory variable was calculated to represent river- and year-specific changes in catch-and-release practices, in particular an increase in the practice of voluntary catch-and-release, and the influence it might have on RER through released fish eventually becoming re-available for capture. There are, however, two reasons why this approach could be improved: (1) catch-and-release has become mandatory on salmon rivers in Wales since 2020 [@Cefas2020] which introduces the possibility that estimates since then might not be directly comparable with the years preceding them, if there is a greater likelihood that catch returns will be falsified under a mandatory regime, and (2) returning salmon back to the river should influence RER indirectly by changing the stock available to be captured within a year, rather than influencing RER directly. To account for changes in catch-and-release practices, such variability could be better explored by treating the available stock as a dynamic rather than static state.

## Salmon rod exploitation rate explanatory variables

We researched and agreed a set of explanatory variables that were expected to describe variation in RER on the PSRs (Table 2).

<!-- Table 2 -->

```{r table2-inline, eval = inline, echo = FALSE}
f_fle <- list.files(path = here(), 
                    pattern = "^explanatory-variables-v[0-9]-[0-9].xlsx")
if (length(f_fle) != 0) {
  foo <- read_xlsx(path = here(f_fle), sheet = "Sheet1")
  foo <- data.frame(foo)
  foo[is.na(foo)] <- ""
  tab2 <- foo[, c("Name", "Description", "Hypothesis", "References")]
  tab2 <- cbind("Model part" = c("Mean", "", "", "", "", "Variance"), tab2)
  kable(tab2, caption = "**Table 2** A set of *a priori* expert-agreed explanatory variables expected to describe mean and variation in Atlantic salmon rod exploitation rate (RER) across the 64 principal salmon rivers in England and Wales. Columns are the explanatory variable *Name* and *Description*, the expert-agreed *Hypothesis* of its effect on either mean or variation in RER, and the main *Reference* informing the hypothesis.", 
        align = rep("l", dim(tab2)[2]), format = "pandoc")
} else {
  NULL
}
```

Through its influence on fish behaviour and availability, and on angler behaviour, river flow is expected to explain variation in salmon catchability and thus RER within and between rivers [reviewed in @Milner2001]. To account for river flow, we calculated a river- and year-specific measure of within angling season *Mean flow* for inclusion in our statistical models of RER (Figure S4). River flow data were obtained from the E&W river flow gauging station network, queried via the UK Centre for Ecology and Hydrology (CEH) National River Flow Archive (<https://nrfa.ceh.ac.uk/>), and individual flow gauging stations, as required. For each river, gauging stations were selected in the lower main river (where possible) to best represent flow conditions on the catchment as a whole and over the period covered by the RSEs (Figure S5). Where suitable gauging stations/flow data were absent from a catchment, flow data from an appropriate neighbouring catchment were used. In all cases, the gauged daily mean flow data extracted to calculate the flow variables were limited to the period of the salmon angling season from the Salmonid and Freshwater Fisheries Statistics (<https://www.gov.uk/government/publications/salmonid-and-freshwater-fisheries-statistics-2020>). The resulting measures of mean flow were *z-*standardised within each river across years before they were included in models as explanatory variables.

To promote generalisation, we calculated variables representing river type and river size for inclusion as explanatory variables in our statistical models of RER. Chalk streams have a higher *Base Flow Index* (Figure S6) than spate rivers because they are largely aquifer-fed and thereby produce a more consistent and higher mean flow. We extracted the Base Flow Index for each of the 64 PSRs from the CEH National River Flow Archive and *z*-standardised them across rivers before including them in models as an explanatory variable. The RER on smaller rivers might be expected to demonstrate higher inter-annual variability as they are likely to accommodate smaller stocks that could thereby be disproportionately affected by processes acting upon them, such as angler behaviour [@Milner2001]. To account for this possibility, we extracted fishery *Area (hectares)* from Table 26 in @Cefas2020 and *z*-standardised it across rivers before including it in models as an explanatory variable.

The RSE and explanatory variables were calculated for each of the 12 PSRs where a RSE is reported and for which a RER can therefore be calculated (Figure 2; see also Figure S7).

<!-- Figure 2 -->

```{r figure2-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 2** Plots showing returning stock estimates (RSE) and explanatory variables expected to describe variation in Atlantic salmon rod exploitation rate for each RSE river. Black lines represent the mean explanatory variable values across all rivers."}
knitr::include_graphics(here("plots", "raw-data-combined-lineplots.jpg"))
```

## Rod exploitation rate model

To address the first objective of our study, we developed a Beta-Binomial model, using the aforementioned *a priori* defined set of expert-agreed potentially influential explanatory variables, to describe the exploitation rate for RSE rivers as a linear combination of the explanatory variables. This is given by:

$$
\begin{array}{c}
C_{r, y} \sim \mbox{Binomial}(N_{r, y}, p_{r, y}) \\
p_{r, y} \sim \mbox{Beta}(\alpha_{r, y}, \beta_{r, y}) \\
\alpha_{r, y} = \mu_{r, y} \phi_{r, y} \\
\beta_{r, y} = (1 - \mu_{r, y}) \phi_{r, y} \\
\mbox{logit}(\mu_{r, y}) = \delta X_{r, y} + \nu_{r} + \zeta_{y} \\
\mbox{log}(\phi_{r, y}) = \gamma Z_{r, y} \\
\end{array}
$$

where

$$
\begin{array}{c}
\nu_{r} \sim \mbox{Normal}(0, \sigma_r) \\
\zeta_{y} \sim \mbox{Normal}(0, \sigma_y)
\end{array}
$$ and

$$
C_{r,y} = c_{r,y} / \lambda
$$

where $c_{r,y}$ is the declared rod catch in river $r$ in year $y$ and $\lambda$ is the licence declaration rate, taken to be 0.91 in most rivers in most years [@Small1985; @Cefas2021], $N_{r,y}$ is the RSE of river $r$ in year $y$, $p_{r,y}$ is the exploitation rate of river $r$ in year $y$, $\alpha$ and $\beta$ are the shape parameters of a Beta distribution, $\delta$ is a vector of coefficients representing the effects of the explanatory variables $X_{r, y}$ on the mean river- and year-specific expected exploitation rate $\mu_{r, y}$, and $\gamma$ is a vector of coefficients representing the effects of the explanatory variables $Z_{y, r}$ on the river- and year-specific variation in exploitation rates $\phi_{r, y}$. Parameters $\nu_{r}$ and $\zeta_{y}$ are random effects allowing the expected mean exploitation rate to vary by $\sigma_r$ among rivers, representing differences between rivers not captured by covariates, and by $\sigma_y$ among years, representing a temporal synchrony between rivers not captured by covariates, respectively. We used weakly informative priors: Gaussian(mean = 0, sd = 1000) for coefficients representing explanatory variable effects on exploitation rate, Student-t(mean = 0, sd = 100, df = 3) for the random effect variance, and Gamma(location = 0.001, scale = 0.001) for the model errors.

The model parameter posterior distributions were estimated from 16000 Markov chain Monte Carlo (MCMC) iterations (8 parallel chains run for 2000 iterations and no thinning) using Hamiltonian Monte Carlo implemented in Stan (<http://mc-stan.org>) and fitted using package `brms` [@Burkner2017] in R (<https://www.r-project.org>) (see the output of `sessionInfo()` in the supplementary materials). Convergence was assessed by visual examination of MCMC trace plots, the Gelman-Rubin statistic [@Brooks1998] and the bulk effective sample size, and were considered stable if the chains were mixing, non-convergent and well represented by the samples, i.e., \<1.05 and \> 200 (per chain) for all parameters, respectively. Bayesian $R^2$ values were calculated according to @Gelman2019.

Given that this model was to be extrapolated to data from rivers not used to parameterise it, it was deemed worthwhile simplifying it to those *a priori* expert-agreed explanatory variables (Table 2) that explained a non-negligible amount of the variation in RER. To do this, we started with the saturated model including all variables (Table 2) and then removed iteratively those whose estimated effect was weakest or most uncertain, i.e., those whose 95% credible intervals intercepted 0 or were widest. We repeated this process until the estimated effects of all remaining variables were considered non-negligible, i.e., their credible intervals did not intercept 0 and were not too wide. The final "best" model was therefore the one explaining the highest variance with the fewest parameters, i.e., the most parsimonious. We confirmed that this was the "best" model according to Information Criterion as the one with the fewest parameters (or explanatory variables) that was also within < 2 change in leave-one-out cross-validation Information Criterion (looIC), known as $\delta$looIC, of the model with the lowest $\delta$looIC (0.00) (Table 3; @Vehtari2017).

## Model validation, inference and extrapolation

To achieve the second objective of our study, the transfer of salmon-counting data from data rich rivers to data-poor rivers without counters, we had to have confidence that our "best" statistical model for the 12 PSRs with a RSE had some predictive ability. To test this, we did a $k = 10$ fold stratified cross-validation experiment whereby we trained the model on nine data folds, each stratified to ensure that all rivers were represented, and used that trained model to predict the total catch on the one omitted fold. We chose to use stratified rather than random samples of the data because there was considerable variation between RER calculated for the 12 PSRs, with a RSE that our model accounted for with a river random effect, the variance of which would not be representative if whole rivers were omitted from the training data. Once satisfied that our model was generalisable, we used it for inference by plotting the partial effects of the retained explanatory variables and comparing their coefficient estimates with the hypothesised relationships (Table 2). 

To achieve our third objective, i.e., to extrapolate our generalisable model to estimate salmon stocks in all 64 PSRs in E&W, we took 2000 draws from the model parameter posteriors and used them to predict an annual RSE ($\hat{N}_{r,y} = C_{r,y}/\hat{p_{r,y}}$, and 95% credible intervals) for each of the other 52 salmon rivers in E&W where an RSE is not reported. This prediction assumed that each river was well represented by the 12 PSRs where an RSE is reported and set the random terms to their means (zero). Resulting estimates included uncertainties, represented by 95% credible intervals.

# Results

Overall, there was substantial between-year variation in calculated RERs for the 12 PSRs where an RSE is reported (both between and within-river) and exploratory analysis suggested that the relationships with the *a priori* chosen explanatory variables were in the directions hypothesised (Figures S1-S6).

## Explanatory variable effects and inference

Posterior estimates of explanatory variable effects from the Beta-Binomial model fits suggested that all *a priori* hypothesised variables, except for *Base Flow Index* (BaseFlowIdx) and  *Area (Hectares)*, explained a non-negligible amount of the variation in the mean of, or variation in, RER for the 12 PSRs where an RSE is reported (Table 3, Figure 3). Specifically, the 95% credible intervals of *Angler effort* (but not its second order term), *Successful effort*, and *Mean flow* effects were narrow did not overlap 0, suggesting that their effects were non-negligible. The 95% credible intervals of *Base Flow Index* and *Area (Hectares)* effects meanwhile, were wide and although they did not overlap 0, their contribution to explaining variation in RER could be considered negligible owing to the high uncertainty in the estimates. Model selection confirmed that the most parsimonious model, taken to be the "best" model taken forward for inference and extrapolation, omitted the *Base Flow Index* and *Area (Hectares)* effects, suggesting that they were negligible (Table 3). MCMC chains for this model were well-mixing according to the convergence statistics (Figure S8) and the random effect estimates were judged to be approximately Gaussian (Figure S9). A summary of the best model is printed in the supplementary material.

<!-- Figure 3 -->

```{r figure3-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 3** A plot of the posterior coefficient estimate means and their 95% credible intervals for explanatory variables retained in the model describing Atlantic salmon rod exploitation rates on the 12 principal salmon rivers in England and Wales where a returning stock estimate (RSE) is reported. The effect of Base Flow Index whose credible intervals overlap the dashed line at 0 was considered negligible, whereas the effects of the other variables were considered non-negligible using Information Criteria."}
knitr::include_graphics(here("plots", "dat-coef-plot.jpg"))
```

<!-- Table 3 -->

```{r table3-inline, eval = inline, echo = FALSE}
f_fle <- list.files(path = here("results"), 
                    pattern = "^model-comparison-table.csv")
if (length(f_fle) != 0) {
  foo <- read.csv(here("results", f_fle), check.names = FALSE)
  tab3 <- foo[, c("name", "mu formula", "phi formula", "looic", "delta_looic", "R2", "best")]
  colnames(tab3) <- c("Name", "$\\mu$ formula", "$\\phi$ formula", "looIC", "$\\delta$looIC", "$R^2$", "Best")
  kable(tab3, caption = "**Table 3** Model comparison table showing the variables tested in the $\\mu$ and $\\phi$ parts of the Beta-Binomial models, the leave-one-out cross-validation Information Criteria (looIC) and its difference from the saturated model ($\\delta$looIC) and the variation explained by the model ($R^2$). The random effect formulation (1 | x) expresses that they were included as random intercepts.", 
        align = rep("l", dim(tab3)[2]), digits = 2, format = "pandoc")
} else {
  NULL
}
```

Plots of the explanatory variable partial effects confirm that the direction of the effects were as hypothesised (Table 2), including a quasi-linear effect of *Angler effort* (Figure 4). Specifically, the effects of *Angler effort*, *Successful effort*, *Mean flow* and *Release proportion* on RER were all positive, albeit sometimes weak.

<!-- Figure 4 -->

```{r figure4-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 4** Partial-effect plots showing the direction, shape and strength of explanatory variable effects on Atlantic salmon rod exploitation rate on the 12 principal salmon rivers in England and Wales where a returning stock estimate (RSE) is reported. Grey bands represent the 95% credible intervals of the partial effects."}
knitr::include_graphics(here("plots", "dat-me-plot.jpg"))
```

Line plots of the observed and estimated RER suggest that the model was able to describe the main patterns in RER inter-annual variations for each of the 12 PSRs with a RSE (Figure 5), albeit with many annual discrepancies, some of which were outside the estimated 95% credible intervals. Specifically, there were large discrepancies between observed and estimated RER on the rivers Avon (Hants), Fowey, Itchen, Kent and Leven, for which the 95% credible intervals of the estimated RER did not always include the observed value. Some of the correspondence between observed and estimated RER was likely helped by the year random effect that allowed for a degree of synchronicity between rivers. 

<!-- Figure 5 -->

```{r figure5-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 5** Plots of the fitted Atlantic salmon rod exploitation rate on the 12 principal salmon rivers in England and Wales where a returning stock estimate (RSE) is reported. Points are the calculated observed RER values (Observation) or the posterior estimate means with error bars represent their 95% credible intervals (Estimation)."}
knitr::include_graphics(here("plots", "dat-exploit-rse-plot.jpg"))
```

## Model validation and extrapolation

Visual inspection of the results from a ($k$ = 10) fold stratified cross-validation experiment suggested that the "best" statistical model was able to predict annual catches for each of the 12 PSRs where a RSE is reported with reasonable certainty (Figure 6). Furthermore, posterior predictive checks suggested that the model was able to reproduce replicate response variables with comparable characteristics (Figure S10).

<!-- Figure 6 -->

```{r figure6-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 6** A plot of the predicted $k = 10$ fold stratified cross-validation Atlantic salmon catches on the 12 principal salmon rivers in England and Wales where a returning stock estimate (RSE) is reported. Points are the observations and the error bands represent the 95% credible intervals of their predicted values from the cross-validation."}
knitr::include_graphics(here("plots", "dat-cv-pred-plot.jpg"))
```

Having confirmed its predictive ability, the model was then extrapolated to the 52 PSRs where a RSE is not reported, as well as those years in the 12 PSRs where RSEs were missing (Figure 7). The resulting extrapolations seemed reasonable and a potentially useful baseline from which local experts and managers could make carefully audited changes.

<!-- Figure 7 -->

```{r figure7-inline, eval = inline, echo = FALSE, fig.cap = "**Figure 7** A plot of the observed and estimated number of returning Atlantic salmon on the 64 principal salmon rivers in England and Wales. Lines link the annual posterior estimate means and confidence bands represent their 95% credible intervals."}
knitr::include_graphics(here("plots", "dat-ew-adult-returns-plot.jpg"))
```

# Discussion

We present a consistent, transparent, and statistically-robust method to derive annual salmon stock estimates from RER for all major salmon-producing rivers across E&W. This method shares similarities with a number of recently published methods, for example @Lebot2022 and @Mantyniemi2015, but it extends them to make use of the comparatively rich data on angler catch and effort available for E&W, and to include consideration of non-linear effects of some of these explanatory variables. Our results suggest that many of these angling data can be included in the model to improve estimates of RER in ways predicted from our expectations. For example, *Angling effort* was positively related to RER [@Davidson2017], as was *Successful effort*, suggesting that patterns in RER could be attributable to a few skilled or persistent anglers, which could see RER increase despite decreasing effort, as has been reported elsewhere [e.g., @Beaumont1991]. Using these additional data can help avoid the need for additional complexities and assumptions (assuming that the data are representative and complete) and might therefore better resonate with fisheries managers and anglers. However, our results also leave space for future and ongoing improvements to the model and its inputs to reduce discrepancies between observed and estimated RER in rivers with a RSE.

To explore whether the model was generalisable, we used a robust and stringent stratified cross-validation procedure. The successful validation of our model suggests that it can be extrapolated to data from rivers that were not used to parameterise it, thereby enabling us to use data from "data-rich" rivers to inform "data-poor" rivers [@Bentley2015]. Furthermore, the model appeared to be robust to rivers with highly contrasting declared salmon catches, deriving plausible predictions for rivers with low declared salmon catches, such as the rivers Stour (SW), Piddle and Yealm, each of which reported no declared catches in at least one year, to rivers with high declared salmon catches, such as the rivers Test and Itchen, perhaps due to more targeted effort on individual fish. There are only six (\<10 %) chalk stream rivers among the 64 PSRs and yet four (30 %) of those were among the 12 for which an RSE is reported and were used to train this RER model. Angler behaviours, and perhaps fish behaviours, might differ for chalk stream rivers compared to non-chalk stream rivers [@Beaumont1991]. Nevertheless, we proposed and tested models including a base flow index as a measure of river type, but this index explained negligible variance in actual RER for the 12 rivers used to train the model. This suggests that any difference in RER between chalk stream and spate rivers is negligible, or at least a less important source of variation than those other explanatory variables that were retained in the final model.

The model outputs provide point estimates of salmon stocks returning to all 64 PSRs in E&W, together with an estimate of their uncertainty. The point estimates are an integral part of the E&W salmon stock assessment procedure, forming the basis for the calculation of spawner and egg numbers used to assess compliance with Conservation Limits and (thereafter) evaluate the need for management intervention to protect stock status [@Cefas2020; @Davidson2017]. A logical extension of this process could be to allow uncertainties in the salmon stock estimates to propagate through to the assessment stage, thereby accounting for some additional uncertainty due to the salmon stock estimation process. For example, egg deposition estimates could be derived from spawning stock estimates including their uncertainties. Allowing for the propagation of such uncertainties through the stock assessment process would align with the precautionary approach recommended by NASCO [@NASCO1998] and with the approaches appearing in neighbouring jurisdictions, such as Ireland [@White2016; @White2023]. In addition to the results for individual rivers, aggregating the salmon stock estimates to the whole E&W spatial scale within the model, thereby allowing for proper propagation of uncertainties, could provide an important input to the international salmon stock assessment process undertaken by the ICES Working Group on North Atlantic Salmon [@ICES-WGNAS2023]. Specifically, the stock estimates and their uncertainties could be conditioned on sea age splits and provided as estimates of adult returns for E&W, obviating the need for run-reconstruction and ensuring the national and international stock abundance estimates are closely aligned.

The Beta-Binomial approach taken here was chosen as a trade-off between ease of understanding and necessary complexity. As a trade-off, it is accepted and indeed encouraged that the outputs from the RER model are subject to review by regional experts before they are used in any stock assessment process. Changes to the outputs could be achieved in a variety of ways, including (but not limited to) (1) modifying the characteristics of the priors given to the model to better represent, for example, mean river-specific RERs, or (2) modifying the outputs directly, especially where there are unique events, such as the introduction of a local byelaw or the effects of the coronavirus pandemic on angling effort [@Cefas2021], that might affect annual estimates in ways that the core RER model may not account for fully. In the former case, without additional information, the salmon stock estimates for rivers where an RSE is not reported will be derived from an overall mean RER (albeit with a river-specific deviation), which might need to be altered to ensure salmon stock estimates are, on average, lower / higher or less / more variable than estimated. In the latter case, it will be imperative that such changes to the output are carefully recorded to ensure that these can be fully accounted for during any audits and future assessments. Aside from the model outputs, the model and its input data should use the best available information and as such are subject to future and ongoing improvements, and we encourage the reader to visit the model codes (released at https://github.com/CefasRepRes/salmon-rod-exploitation) to check for updates.

If we can move away from the need for ease of understanding and incorporate additional complexities that might make the estimate of salmon stocks even more realistic, then there are a few clear ways that our model could be improved. Although we included *Release proportion* as an explanatory variable of RER in our model, we know that releasing a fish back into the river -- although it won't change the annual run of fish to that river (or RSE) -- will, in general terms, change the number of fish available to be caught when compared, for example, to past practices where it was usual for most rod-caught fish to be killed. However, while more fish may be available to capture (in relative terms, because they are being released rather than killed) than in former times, the true rate at which they are caught (i.e., the vulnerability to capture of the average fish) may not change greatly. If this was an issue, we could address it by modelling the number of available fish explicitly. This could be done by, for example, using a separate sub-model to estimate the number of fish available, such as a coupled Poisson-Binomial approach [e.g., @Marsh2021a; @Lebot2022], or by using state-space models that model the ecological and observation processes separately [@Gregory2019; @Buoro2019]. Either of these approaches would allow other available data representing factors affecting catches or stocks to be incorporated directly, rather than by proxy. Whether this type of alternative approach is needed would require further investigation into this issue. 

Another extension of our model would be to modify it to estimate different salmon stock components separately -- namely one-sea-winter and multi-sea-winter fish -- rather than combined, as is done here. Salmon stock assessments frequently account for these two sea-age groups separately, principally for fisheries management purposes because they have different reproductive potentials, but also to help maintain the biological diversity of returning stocks. This has been the case, for example, in the high seas mixed-stock fisheries off Greenland and the Faroes, where these two stock components have faced different levels of exploitation by virtue of different migratory patterns [@ICES-WGNAS2021]. Similarly, management of homewater fisheries in the UK and elsewhere accounts for one-sea-winter and multi-sea-winter fish separately, although the Conservation Limits set for individual river stocks in E&W do not distinguish between these stock components. Salmon that have spent longer at sea tend to be larger and enter rivers earlier than those staying out for shorter periods. Larger salmon produce more eggs, but can also be subjected to different (higher) RERs as anglers seek bigger quarry, but also, in the case of early run multi-sea-winter fish, because of differences in catchability and the length of time fish are exposed to the fisheries [@Davidson2000; @Shelton2001a]. These points could have important implications for salmon stock assessment [@Thorley2007; @Lebot2022]. Sea-age-specific RERs could be dealt with separately by extending this Binomial sampling to multinomial sampling with Dirichlet priors informed by sea-age specific explanatory variables [@Douma2019].

Aside from modifications to the approach taken here, the outputs could also be improved by enhancements to the inputs. For example, we could include additional explanatory variables to explain more of the high inter-annual variability in RER. These might include angling method/gear [@Grilli2021; @Shields2007], which could also extend to angling restrictions, such as bait bans and barbless hooks. Data on the method of capture are submitted as part of routine catch returns, but they refer to captured fish only and so may not reflect method selection generally. Ideally, to include 'capture method', we would want to ensure that the sample of rivers used to parameterise the model included some that prohibited certain angling methods alongside others that did not. Another area for possible model improvement relates to variation in migration or run timing of returning adult salmon. Evidence suggests, sometimes from fish counters and traps, that run timings have changed and might continue to change, perhaps in response to changing conditions at sea [@Eyto2022]. Although this could be considered as an additional explanatory variable, as suggested above it could be better represented in state-space models. 

Notwithstanding additional explanatory variables, we could also improve the variables already included. For example, *Angler effort* is currently adjusted to separate effort for salmon *vs.* sea trout; however, this adjustment is made based on only two angler surveys several years apart. Instead, rod licence returns could be adjusted to ask anglers to specify their effort split as part of routine rod licence reporting. Similarly, *Angler effort* is currently recorded only in 'days' (effectively the number of daily fishing sessions per river per year), whereas actual time spent fishing would be more nuanced and, if this were better recorded, then it could be used to produce a more realistic weighting of angler effort. After investigations into a variety of flow metrics, such as numbers of seasonal spate events, we used river discharge as *Mean flow*. There are, however, many other ways that this could be defined (see @Gillson2020) that could better explain variation in RER while also capturing our understanding of the complex relationships between river discharge, fish and angler behaviours. Notwithstanding changes to the inputs, we could also include additional random terms that could allow for between-year variation within rivers, for example.

In conclusion, salmon stock sizes have declined dramatically over the last 70 years [@Chaput2012; @Limburg2009; @ICES-WGNAS2021]. Commercial salmon fishing was cited as the main driver of these declines during the 20th century [@Chaput2012; @Limburg2009], particularly large commercial catches off West Greenland, where salmon are thought to aggregate on feeding grounds [@Dadswell2010; @Olmos2019]. Yet, salmon stock sizes have continued to decline despite the closure of those commercial fisheries in 1998, leading to widespread closures of local and small-scale mixed stock fisheries along national coastlines and in river estuaries [@Chase2003]. While there is no doubt that these closures have been beneficial to salmon stock numbers, they represent the loss of a data stream that could have been used in national and international salmon stock assessments [@Youngson2003].

Given the state of salmon stocks and the subsequent loss of stock assessment data, there is a need to use available data to the best effect possible. To this end, the approach to estimating salmon stocks for all 64 PSRs in E&W presented here represents a consistent, transparent, and statistically-robust method that uses information from "data-rich" rivers to inform estimates for "data-poor" rivers. This approach could be extended relatively simply to include newly available data, such as may derive from to technological advances or exploiting publicly available data [@Lennox2022], and could form the basis of a more comprehensive approach that separates the ecological and observation processes, should that be needed. It does, however, still require angler-reported catch and effort data and some fishery-independent stock estimates without which we will need to seek an alternative approach to stock estimation.

# Supplementary data

Supplementary material is available at the ICESJMS online version of the manuscript.

# Acknowledgements

We acknowledge the work of local and national Environment Agency and Natural Resources Wales staff in their ongoing commitment to deriving annual returning adult Atlantic salmon stock estimates and their feedback on this proposed approach. We also thank N. J. Milner, E. Rivot, and G. H. Copp for their helpful comments and suggestions on an earlier draft of this work. A salmon rod exploitation methodology review was commissioned jointly by the EA and NRW national stock assessment process by ST and PG (and more laterly, BW) on behalf of their respective organisations. 

# Conflict of interest statement

All authors declare no conflict of interest.

# Funding

This study was part-funded by core funding (Grant-in-Aid) from the Department for Environment, Food and Rural Affairs (Defra) to Cefas and the EA, and the European Regional Development Fund through the Interreg Channel VA Programme under project SAMARCH.

# Data availability statement

The data underlying this article are available on request from Simon Toms (EA; [simon.toms@environment-agency.gov.uk](mailto:simon.toms@environment-agency.gov.uk)) and Ian Davidson (NRW; [ian.davidson@cyfoethnaturiolcymru.gov.uk](mailto:ian.davidson@cyfoethnaturiolcymru.gov.uk)). All code is available from the Cefas GitHub [https://github.com/CefasRepRes](https://github.com/CefasRepRes).

# Author contributions statement

All authors participated in meetings that formed the basis of this manuscript. SDG, JPG and ICD designed and did the analysis. KW, RJH, BS, LT and ICD curated and provided access to the data. All authors provided expertise and contributed to the writing of this manuscript.

# References

::: {#refs}
:::

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

```{r, results ="asis", eval = !inline}
cat("# Tables \n")
```

<!-- Table 1 -->

```{r table1, eval = !inline, echo = FALSE}
f_fle <- list.files(path = here(), 
                    pattern = "^explanatory-variables-v[0-9]-[0-9].xlsx")
if (length(f_fle) != 0) {
  foo <- read_xlsx(path = here(f_fle), sheet = "Sheet1")
  foo <- data.frame(foo)
  foo[is.na(foo)] <- ""
  tab1 <- foo[, c("Name", "Description", "Hypothesis", "References")]
  kable(tab1, caption = "**Table 1** A set of *a priori* expert-agreed explanatory variables expected to describe variation in Atlantic salmon rod exploitation rate (RER) across the 64 principal salmon rivers in England and Wales. Columns are the explanatory variable *Name* and *Description*, the expert-agreed *Hypothesis* of its effect on RER, and the main *Reference* informing the hypothesis.", 
        align = rep("l", dim(tab1)[2]), format = "pandoc")
} else {
  NULL
}
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Table 2 -->

```{r table2, eval = !inline, echo = FALSE}
f_fle <- list.files(path = here(), 
                    pattern = "^rse-psr-descriptions.csv")
if (length(f_fle) != 0) {
  tab2 <- read.csv(here(f_fle))
  tab2 <- data.frame(tab2)
  kable(tab2, caption = "**Table 2** Details of the 12 principal salmon rivers in England and Wales that derive a fishery-independent returning stock estimate (RSE). **To complete - see `rse-psr-descriptions-v1-1.xlsx`**. Duration indicates the extent of the returning stock estimate time-series in years. Gaps shows the years where a returning stock estimate is absent. Source denotes the origins of the returning stock estimate. Format refers to whether the returning stock estimate is made throughout or part of the year (i.e., a full or partial count) with the duration shown in parentheses. Validation denotes the method of substantiating the returning stock estimate.", align = rep("l", dim(tab1)[2]), format = "pandoc")
} else {
  NULL
}
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Table 3 -->

```{r table3, eval = !inline, echo = FALSE}
f_fle <- list.files(path = here("results"), 
                    pattern = "^model-comparison-table.csv")
if (length(f_fle) != 0) {
  foo <- read.csv(here("results", f_fle), check.names = FALSE)
  tab3 <- foo[, c("name", "mu formula", "phi formula", "looic", "delta_looic", "R2", "best")]
  colnames(tab3) <- c("Name", "$\\mu$ formula", "$\\phi$ formula", "looIC", "$\\delta$looIC", "$R_2$", "Best")
  kable(tab3, caption = "**Table 3** Model comparison table showing the variables tested in the $\\mu$ and $\\phi$ parts of the Beta-Binomial models, the leave-one-out cross-validation Information Criteria (looIC) and its difference from the saturated model ($\\delta$looIC) and the variation explained by the model ($R_2$).", 
        align = rep("l", dim(tab3)[2]), digits = 2, format = "pandoc")
} else {
  NULL
}
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
cat("# Figures \n")
```

<!-- Figure 1 -->

```{r figure1, eval = !inline, echo = FALSE, fig.cap = "**Figure 1** Locations of the 64 principal salmon rivers (PSR) in England and Wales. Only 12 of these PSR (indicated by grey boxes) has a fish counter or trap to derive a returning stock estimate that is needed to calculate a rod exploitation rate."}
knitr::include_graphics(here("plots", "river-locations.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 2 -->

```{r figure2, eval = !inline, echo = FALSE, fig.cap = "**Figure 2** Plots showing returning stock estimates (RSE) and explanatory variables expected to describe variation in Atlantic salmon rod exploitation rate for each RSE river. Black lines represent the mean explanatory variable values over all rivers."}
knitr::include_graphics(here("plots", "raw-data-combined-lineplots.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 3 -->

```{r figure3, eval = !inline, echo = FALSE, fig.cap = "**Figure 3** A plot showing the posterior coefficient estimate means and their 95% credible intervals for explanatory variables retained in the model describing Atlantic salmon rod exploitation rates on the 12 principle salmon rivers in England and Wales that produce a returning stock estimate (RSE). The effects of explanatory variables whose credible intervals overlap the dashed line at 0 are considered negligible."}
knitr::include_graphics(here("plots", "dat-coef-plot.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 4 -->

```{r figure4, eval = !inline, echo = FALSE, fig.cap = "**Figure 4** Partial effect plots showing the direction, shape and strength of explanatory variable effects on Atlantic salmon rod exploitation rate of the 12 principle salmon rivers in England and Wales that produce a returning stock estimate (RSE). Gray bands represent the 95% credible intervals of the partial effects."}
knitr::include_graphics(here("plots", "dat-me-plot.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 5 -->

```{r figure5, eval = !inline, echo = FALSE, fig.cap = "**Figure 5** Plots showing the fitted Atlantic salmon rod exploitation rate on the 12 principle salmon rivers in England and Wales that produce a returning stock estimate (RSE). Points are the posterior estimate means and error bars represent their 95% credible intervals."}
knitr::include_graphics(here("plots", "dat-exploit-rse-plot.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 6 -->

```{r figure6, eval = !inline, echo = FALSE, fig.cap = "**Figure 6** A plot showing the predicted $k = 10$ fold stratified cross-validation Atlantic salmon catches on the 12 principle salmon rivers in England and Wales that produce a returning stock estimate (RSE). Points are the posterior estimate means and error bars represent their 95% credible intervals."}
knitr::include_graphics(here("plots", "dat_cv_pred_plot.jpg"))
```

```{r, results = "asis", eval = !inline}
cat("\\newpage")
```

<!-- Figure 7 -->

```{r figure7, eval = !inline, echo = FALSE, fig.cap = "**Figure 7** A plot showing the observed and estimated number of returning Atlantic salmon on the 64 principle salmon rivers in England and Wales. Lines link the annual posterior estimate means and confidence bands represent their 95% credible intervals."}
knitr::include_graphics(ere("plots", "dat_ew_adult_returns_plot.jpg"))
```
