---
# Document details
title: "Estimation of returning Atlantic salmon stock from rod exploitation rate for principal salmon rivers in England & Wales: supplementary material"
# date: "`r format(Sys.time(), '%A %d %B %Y')`"
author: "Stephen D. Gregory^1,2,3,*^, Jonathan P. Gillson^4^, Katie Whitlock^5^, Jon Barry^4^, Peter Gough^6^, Robert J. Hillman^5^, David Mee^6^, Graeme Peirson^5^, Brian A. Shields^5^, Lawrence Talks^5^, Simon Toms^5^, Alan M. Walker^4^, Ben Wilson^6^, Ian C. Davidson^6^"
abstract: |

  ^1^ Salmon & Trout Research Centre, Game and Wildlife Conservation Trust, East Stoke, BH20 6BB, UK
  
  ^2^ Centre for Environment, Fisheries and Aquaculture Science, Barrack Road, Weymouth, DT4 8UB, UK
  
  ^3^ Centre for Conservation Ecology and Environmental Sciences, Faculty of Science and Technology, Bournemouth University, Talbot Campus, Poole, Dorset, BH12 5BB, UK

  ^4^ Centre for Environment, Fisheries and Aquaculture Science, Pakefield Road, Lowestoft, NR33 0HT, UK

  ^5^ Environment Agency, Horizon House, Deanery Rd, Bristol, BS1 5AH, UK
  
  ^6^ Natural Resources Wales, Ty Cambria, 29 Newport Rd, Cardiff, CF24 0TP, UK
  
  \* Corresponding author: tel: +44 1305 206 703; email: [stephen.gregory@cefas.gov.uk](mailto:stephen.gregory@cefas.gov.uk).
  
# Output details
format: docx

# References
csl: ices-journal-of-marine-science.csl # more at www.zotero.org/styles
bibliography: references.bib
link-citations: true

# editor
editor: source

# Analysis details
version: "`r version$version.string`"
packages: "`r names(sessionInfo()$otherPkgs)`"
dependencies: "none"
---

<!-- ## Todo -->

<!-- 1)  Simulation study example; -->

<!-- 2)  RiverType raw plot; -->

# Output of `sessionInfo()`

```{r, echo = FALSE, warning = FALSE, message = FALSE}
# libraries
library(knitr, quietly = TRUE)
opts_knit$set(warning = FALSE, message = FALSE, commment = NA, eval = FALSE)
opts_chunk$set(fig.width = 12, fig.height = 8, fig.path = "plots/", 
               echo = FALSE, warning = FALSE, message = FALSE)
library(here)
library(readxl)
source(here("scripts", "libraries-and-functions.R"))
```

```{r, echo = TRUE}

sessionInfo()

```

\newpage

# Supplementary figures

<!-- Figure S1 -->

```{r figureS1, eval = TRUE, echo = FALSE, fig.cap = "**Figure S1** Plot of the relationship between calculated extant Atlantic salmon rod exploitation rate and (log10-transformed) salmon fishing effort by area. Data are for the 12 Principal Salmon Rivers (PSR) equipped with a fish counter and derive a fishery-independent returning stock estimate (RSE). Blue lines are linear fits and red lines are quadratic fits."}
knitr::include_graphics(here("plots", "exploit-effort-scatterplot.jpg"))
```

\newpage

<!-- Figure S2 -->

```{r figureS2, eval = TRUE, echo = FALSE, fig.cap = "**Figure S2** Plot of the relationship between calculated extant Atlantic salmon rod exploitation rate and the proportion of effort that yielded a catch. Data are for the 12 Principal Salmon Rivers (PSR) equipped with a fish counter and derive a fishery-independent returning stock estimate (RSE). Blue lines are linear fits and red lines are quadratic fits."}
knitr::include_graphics(here("plots", "exploit-successeff-scatterplot.jpg"))
```

\newpage

<!-- Figure S3 -->

```{r figureS3, eval = TRUE, echo = FALSE, fig.cap = "**Figure S3** Plot of the relationship between calculated extant Atlantic salmon rod exploitation rate and the proportion of salmon released during the salmon angling season. Data are for the 12 Principal Salmon Rivers (PSR) equipped with a fish counter and derive a fishery-independent returning stock estimate (RSE). Blue lines are linear fits and red lines are quadratic fits."}
knitr::include_graphics(here("plots", "exploit-prelease-scatterplot.jpg"))
```

\newpage

<!-- Figure S4 -->

```{r figureS4, eval = TRUE, echo = FALSE, fig.cap = "**Figure S4** Plot of the relationship between calculated extant Atlantic salmon rod exploitation rate and mean flow during the salmon angling season. Data are for the 12 Principal Salmon Rivers (PSR) equipped with a fish counter and derive a fishery-independent returning stock estimate (RSE). Blue lines are linear fits and red lines are quadratic fits."}
knitr::include_graphics(here("plots", "exploit-mnflow-scatterplot.jpg"))
```

\newpage

<!-- Figure S5 -->

```{r figureS5, eval = TRUE, echo = FALSE, fig.cap = "**Figure S5** A map of the river flow gauging stations used in the derivation of the explanatory flow variables."}
knitr::include_graphics(here("plots", "gauging-station-locations.jpg"))
```

\newpage

<!-- Figure S6 -->

```{r figureS6, eval = TRUE, echo = FALSE, fig.cap = "**Figure S6** A plot of the classification of river types: Principal Salmon Rivers with a Base Flow Index of 0.7 or above were classified as chalk rivers; the others were classified as rain-fed rivers. Grey boxes highlight rivers that report a returning stock estimate (RSE)."}
knitr::include_graphics(here("plots", "base-flow-indexes.jpg"))
```

\newpage

<!-- Figure S7 -->

```{r figureS7, eval = TRUE, echo = FALSE, fig.cap = "**Figure S7** Histograms of the explanatory variables used in the saturated model. Variable abbreviations are given in the main text."}
knitr::include_graphics(here("plots", "dat-expl-hists.jpg"))
```

\newpage

<!-- Figure S8 -->

```{r figureS8, eval = TRUE, echo = FALSE, fig.cap = "**Figure S8** Trace plots of mixing of the 3 Monte Carlo Markov Chains (MCMC) used to estimate model coefficient values (and other values, such as random effects; not shown here). Variable abbreviations are given in the main text."}
knitr::include_graphics(here("plots", "dat-trace-plot.jpg"))
```

\newpage

<!-- Figure S9 -->

```{r figureS9, eval = TRUE, echo = FALSE, fig.cap = "**Figure S9** Quantile-quantile plots of the random effect estimates and their sample compared to their theoretical distributions."}
knitr::include_graphics(here("plots", "dat-ranef-plot.jpg"))
```

\newpage

<!-- Figure S10 -->

```{r figureS10, eval = TRUE, echo = FALSE, fig.cap = "**Figure S10** Posterior predictive plots showing 10 replicate response variables simulated from the 'best model' posterior parameter estimates and compared to the actual response variable."}
knitr::include_graphics(here("plots", "dat-pp-check-plot.jpg"))
```

\newpage

<!-- model summary -->

# `summary()` of best model

```{r modelsumm, eval = TRUE, echo = FALSE, result = "asis"}

## read the best model
load(here("Results", "rod-exploitation-fitting-results.RData"))

## print the summary
print(summary(best_fit))

```

